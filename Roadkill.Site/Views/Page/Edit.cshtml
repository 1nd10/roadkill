@model PageSummary

<script type="text/javascript">
// Used for the WMD editor for markdown
var roadkillManagerUrl = "@(Url.Content("~/Page/AllFiles/" +Model.Id))";
var _tags;

$(document).ready(function () 
{
	setTimeout("loadTags();",2000);
	initTagIt();
});

function loadTags()
{
	$.get("@(@Url.Action("AllTagsAsJson","Page"))",function(data)
	{
		_tags = eval(data);
		initTagIt();
	});
}

function initTagIt()
{
	$("#mytags").tagit({
		availableTags: _tags,
		singleField: true,
		singleFieldNode: $("#Tags"),
		singleFieldDelimiter: ";"
	});
}
</script>
<link href="@Url.Content("~/Assets/Scripts/Wmd/wmd.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Assets/Scripts/Wmd/wmd.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Assets/Scripts/Wmd/showdown.js")" type="text/javascript"></script>

@Html.ValidationSummary("Saving the page was unsuccessful. Please correct the errors and try again.")

@using (Html.BeginForm())
{
@(Html.HiddenFor<PageSummary, Guid>(p => p.Id))
<span>Title:</span> @(Html.TextBoxFor<PageSummary, string>(p => p.Title))<br />
@(Html.HiddenFor<PageSummary, string>(p => p.Tags))<br />
<div class="tagit">
	<label for="tags">Tags</label>
	<ul id="mytags"></ul>
</div>


if (!Model.IsNew)
{
<span>Current version:</span> @Model.VersionNumber <br />
}

<div style="margin:0;">
<div id="wmd-button-bar"></div>
@(Html.TextAreaFor<PageSummary, string>(p => p.Content, new { cols = "80", rows = "80", @class = "wmd-textarea wmd-panel" }))
<br />
<input type="submit" />
<h1>Preview</h1>
<div id="wmd-preview" class="wmd-panel"></div>
</div>
}
